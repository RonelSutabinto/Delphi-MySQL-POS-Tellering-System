                     UpdateARLedgerDebit.ParambyName('Code').Text                           := MasterCode.Text;
                     UpdateARLedgerDebit.ParambyName('Date').AsDate                         := now;
                     UpdateARLedgerDebit.ParambyName('Document').Text                       := POEBRNumber[I];
                     UpdateARLedgerDebit.ParambyName('BillMonth').Text                      := SBBillMonth.Text;
                     UpdateARLedgerDebit.ParambyName('Reading').Text                        := SBPresentReading.Text;
                     UpdateARLedgerDebit.ParambyName('KilowattHour').Text                   := SBKilowattHour.Text;
                     UpdateARLedgerDebit.ParambyName('Debit').AsFloat                       := SBAmount.AsFloat;
                     UpdateARLedgerDebit.ParambyName('UCNPCSD').AsCurrency                  := BillUCNPCStrandedDebts;
                     UpdateARLedgerDebit.ParambyName('UCNPCSCC').AsCurrency                 := BillUCNPCStrandedContCost;
                     UpdateARLedgerDebit.ParambyName('UCDUSCC').AsCurrency                  := BillUCDUStrandedContCost;
                     UpdateARLedgerDebit.ParambyName('UCME').AsCurrency                     := BillUCME;
                     UpdateARLedgerDebit.ParambyName('UCETR').AsCurrency                    := BillUCEqTaxesAndRoyalties;
                     UpdateARLedgerDebit.ParambyName('UCEC').AsCurrency                     := BillUCEC;
                     UpdateARLedgerDebit.ParambyName('UCCSR').AsCurrency                    := BillUCCrossSubRemoval;
                     UpdateARLedgerDebit.ParambyName('VATDiscAmt').AsCurrency               := BillVATDiscAmt;
                     UpdateARLedgerDebit.ParambyName('VATDistDiscAmt').AsCurrency           := BillVATDistDiscAmt;
                     UpdateARLedgerDebit.ParambyName('VATGenCODiscAmt').AsCurrency          := BillVATGenCoDiscAmt;
                     UpdateARLedgerDebit.ParambyName('VATTransCODiscAmt').AsCurrency        := BillVATTransCoDiscAmt;
                     UpdateARLedgerDebit.ParambyName('VATSystemLossDiscAmt').AsCurrency     := BillVATSystemLossDiscAmt;
                     UpdateARLedgerDebit.ParambyName('VAT').AsCurrency                      := BillVAT;
                     UpdateARLedgerDebit.ParambyName('VATDist').AsCurrency                  := BillVATDist;
                     UpdateARLedgerDebit.ParambyName('VATGenCO').AsCurrency                 := VATGenCO;
                     UpdateARLedgerDebit.ParambyName('VATTransCO').AsCurrency               := VATTransCO;
                     UpdateARLedgerDebit.ParambyName('VATSystemLossGenCO').AsCurrency       := VATSystemLoss;
                     UpdateARLedgerDebit.ParambyName('VATSystemLossTransCO').AsCurrency     := 0.00;
                     UpdateARLedgerDebit.Execute;

                     BillHistoryUpdateQuery.ParamByName('Code').Text                        := MasterCode.Text;
                     BillHistoryUpdateQuery.ParamByName('Area').Text                        := MasterArea.Text;
                     BillHistoryUpdateQuery.ParamByName('Book').Text                        := MasterBook.Text;
                     BillHistoryUpdateQuery.ParamByName('Sequence').Text                    := MasterSequence.Text;
                     BillHistoryUpdateQuery.ParamByName('AccountNumber').Text               := MasterAccountNumber.Text;
                     BillHistoryUpdateQuery.ParamByName('Name').Text                        := copy(MasterName.Text,1,30);
                     BillHistoryUpdateQuery.ParamByName('Address').Text                     := copy(MasterAddress.Text,1,30);
                     BillHistoryUpdateQuery.ParamByName('RateCode').Text                    := MasterRateCode.Text;
                     BillHistoryUpdateQuery.ParamByName('Serial').Text                      := MasterSerial.Text;
                     BillHistoryUpdateQuery.ParamByName('Multiplier').AsInteger             := MasterMultiplier.AsInteger;
                     BillHistoryUpdateQuery.ParamByName('PreviousReadingDate').AsDate       := MasterPresentReadingDate.AsDateTime;
                     BillHistoryUpdateQuery.ParamByName('PresentReadingDate').AsDate        := Now;
                     BillHistoryUpdateQuery.ParamByName('PresentReadingKWH').AsFloat        := SBPresentReading.AsFloat;
                     BillHistoryUpdateQuery.ParamByName('PreviousReadingKWH').AsFloat       := SBPreviousReading.AsFloat;
                     BillHistoryUpdateQuery.ParamByName('Diff').AsFloat                     := SBKilowattHour.AsFloat;
                     BillHistoryUpdateQuery.ParamByName('Demand').AsFloat                   := MasterDemand.AsFloat;
                     BillHistoryUpdateQuery.ParamByName('FlatRateWattage').AsFloat          := MasterFlatRateWattage.AsFloat;
                     BillHistoryUpdateQuery.ParamByName('FeedBackCode').Text                := MasterFeedBackCode.Text;
                     BillHistoryUpdateQuery.ParamByName('CM').Text                          := MasterCM.Text;
                     BillHistoryUpdateQuery.ParamByName('CMMultiplier').AsInteger           := MasterCMMultiplier.AsInteger;
                     BillHistoryUpdateQuery.ParamByName('CMPreviousReadingKWH').AsInteger   := MasterCMPreviousReadingKWH.AsInteger;
                     BillHistoryUpdateQuery.ParamByName('CMPresentReadingKWH').AsInteger    := MasterCMPresentReadingKWH.AsInteger;
                     BillHistoryUpdateQuery.ParamByName('CMKilowattHour').AsInteger         := (StrToInt(SBCMLastRead.Caption) - StrToInt(SBCMPrevRead.Caption) * StrToInt(SBCMMult.Caption));
                     BillHistoryUpdateQuery.ParamByName('CMDemand').AsFloat                 := MasterCMDemand.AsFloat;
                     BillHistoryUpdateQuery.ParamByName('KilowattHour').AsFloat             := SBKilowattHour.AsFloat;
                     BillHistoryUpdateQuery.ParamByName('KilowattUsed').AsFloat             := MasterDemand.AsFloat;
                     BillHistoryUpdateQuery.ParamByName('GenSysCharge').AsFloat             := BillGenSysCharge;
                     BillHistoryUpdateQuery.ParamByName('HostCommCharge').AsFloat           := BillHostCommCharge;
                     BillHistoryUpdateQuery.ParamByName('ForexCharge').AsFloat              := BillForexCharge;
                     BillHistoryUpdateQuery.ParamByName('TCDemandCharge').AsFloat           := BillTCDemandCharge;
                     BillHistoryUpdateQuery.ParamByName('TCTransSystemCharge').AsFloat      := BillTCTransSystemCharge;
                     BillHistoryUpdateQuery.ParamByName('SystemLossCharge').AsFloat         := BillSystemLossCharge;
                     BillHistoryUpdateQuery.ParamByName('DCDemandCharge').AsFloat           := BillDCDemandCharge;
                     BillHistoryUpdateQuery.ParamByName('DCDistributionCharge').AsFloat     := BillDCDistributionCharge;
                     BillHistoryUpdateQuery.ParamByName('SCRetCustCharge').AsFloat          := BillSCRetCustCharge;
                     BillHistoryUpdateQuery.ParamByName('SCSupplySysCharge').AsFloat        := BillSCSupplySysCharge;
                     BillHistoryUpdateQuery.ParamByName('MCRetailCustCharge').AsFloat       := BillMCRetailCustCharge;
                     BillHistoryUpdateQuery.ParamByName('MCSystemCharge').AsFloat           := BillMCSystemCharge;
                     BillHistoryUpdateQuery.ParamByName('UCNPCStrandedDebts').AsFloat       := BillUCNPCStrandedDebts;
                     BillHistoryUpdateQuery.ParamByName('UCNPCStrandedContCost').AsFloat    := BillUCNPCStrandedContCost;
                     BillHistoryUpdateQuery.ParamByName('UCDUStrandedContCost').AsFloat     := BillUCDUStrandedContCost;
                     BillHistoryUpdateQuery.ParamByName('UCME').AsFloat                     := BillUCME;
                     BillHistoryUpdateQuery.ParamByName('UCEqTaxesAndRoyalties').AsFloat    := BillUCEqTaxesAndRoyalties;
                     BillHistoryUpdateQuery.ParamByName('UCEC').AsFloat                     := BillUCEC;
                     BillHistoryUpdateQuery.ParamByName('UCCrossSubRemoval').AsFloat        := BillUCCrossSubRemoval;
                     BillHistoryUpdateQuery.ParamByName('ICCrossSubsidyCharge').AsFloat     := BillICCrossSubsidyCharge;
                     BillHistoryUpdateQuery.ParamByName('PowerActRateRed').AsFloat          := BillPowerActRateRed;
                     BillHistoryUpdateQuery.ParamByName('LifelineDiscSubs').AsFloat         := BillLifelineDiscSubs;
                     BillHistoryUpdateQuery.ParamByName('LoanCondo').AsFloat                := BillLoanCondo;
                     BillHistoryUpdateQuery.ParamByName('TransformerRental').AsCurrency     := MasterTransformerRental.AsCurrency;
                     BillHistoryUpdateQuery.ParamByName('OCCode1').Text                     := MasterOCCode1.Text;
                     BillHistoryUpdateQuery.ParamByName('OCAmount1').AsCurrency             := MasterOCAmount1.AsCurrency;
                     BillHistoryUpdateQuery.ParamByName('OCMo1').AsCurrency                 := MasterOCMo1.AsCurrency;
                     BillHistoryUpdateQuery.ParamByName('OCTotal1').AsCurrency              := MasterOCTotal1.AsCurrency;
                     BillHistoryUpdateQuery.ParamByName('OCCode2').Text                     := MasterOCCode2.Text;
                     BillHistoryUpdateQuery.ParamByName('OCAmount2').AsCurrency             := MasterOCAmount2.AsCurrency;
                     BillHistoryUpdateQuery.ParamByName('OCMo2').AsCurrency                 := MasterOCMo2.AsCurrency;
                     BillHistoryUpdateQuery.ParamByName('OCTotal2').AsCurrency              := MasterOCTotal2.AsCurrency;
                     BillHistoryUpdateQuery.ParamByName('OCCode3').Text                     := MasterOCCode3.Text;
                     BillHistoryUpdateQuery.ParamByName('OCAmount3').AsCurrency             := MasterOCAmount3.AsCurrency;
                     BillHistoryUpdateQuery.ParamByName('OCMo3').AsCurrency                 := MasterOCMo3.AsCurrency;
                     BillHistoryUpdateQuery.ParamByName('OCTotal3').AsCurrency              := MasterOCTotal3.AsCurrency;
                     BillHistoryUpdateQuery.ParamByName('TotalBill').AsCurrency             := BillTotalBill;
                     BillHistoryUpdateQuery.ParamByName('BillNumber').Text                  := POEBRNumber[I];
                     BillHistoryUpdateQuery.ParamByName('OEBRNumber').Text                  := POEBRNumber[I];
                     BillHistoryUpdateQuery.ParamByName('BillMonth').Text                   := SBBillMonth.Text;
                     BillHistoryUpdateQuery.ParamByName('BillDate').AsDate                  := Now;
                     BillHistoryUpdateQuery.ParamByName('StatusCode').Text                  := '2';
                     BillHistoryUpdateQuery.ParamByName('LCCustMo').AsFloat                 := BillLCCustMo;
                     BillHistoryUpdateQuery.ParamByName('PrevYearAdjPowerCost').AsCurrency  := BillPrevYearAdjPowerCost;
                     BillHistoryUpdateQuery.ParamByName('SysLossUnderRecov').AsCurrency     := BillSysLossUnderRecov;
                     BillHistoryUpdateQuery.ParamByName('VATDiscAmt').AsCurrency            := BillVATDiscAmt;
                     BillHistoryUpdateQuery.ParamByName('VATDistDiscAmt').AsCurrency        := BillVATDistDiscAmt;
                     BillHistoryUpdateQuery.ParamByName('VATGenCoDiscAmt').AsCurrency       := BillVATGenCoDiscAmt;
                     BillHistoryUpdateQuery.ParamByName('VATTransCoDiscAmt').AsCurrency     := BillVATTransCoDiscAmt;
                     BillHistoryUpdateQuery.ParamByName('VATSystemLossDiscAmt').AsCurrency  := BillVATSystemLossDiscAmt;
                     BillHistoryUpdateQuery.ParamByName('VATDist').AsCurrency               := BillVATDist;
                     BillHistoryUpdateQuery.ParamByName('VATGenCO').AsCurrency              := VATGenCO;
                     BillHistoryUpdateQuery.ParamByName('VATTransCO').AsCurrency            := VATTransCO;
                     BillHistoryUpdateQuery.ParamByName('VATSystemLossGenCO').AsCurrency    := VATSystemLoss;
                     BillHistoryUpdateQuery.ParamByName('VATSystemLossTransCO').AsCurrency  := 0.00;
                     BillHistoryUpdateQuery.ParamByName('VAT').AsCurrency                   := BillVAT;
                     BillHistoryUpdateQuery.ParamByName('VATDisc').AsCurrency               := MasterVATDisc.AsCurrency;
                     BillHistoryUpdateQuery.ParamByName('AdjAmountBalance').AsCurrency      := 0.00;
                     BillHistoryUpdateQuery.ParamByName('AdjAmountApplied').AsCurrency      := BillAdjAmountApplied;
                     BillHistoryUpdateQuery.Execute;

                     MasterUpdateQuery.ParamByName('FeedBackCode').Text                     := MasterFeedBackCode.Text;
                     MasterUpdateQuery.ParamByName('PreviousReadingDate').AsDate            := MasterPresentReadingDate.AsDateTime;
                     MasterUpdateQuery.ParamByName('PresentReadingDate').AsDate             := Now;
                     MasterUpdateQuery.ParamByName('PreviousReadingKWH').AsFloat            := SBPreviousReading.AsFloat;
                     MasterUpdateQuery.ParamByName('PresentReadingKWH').AsFloat             := SBPresentReading.AsFloat;
                     MasterUpdateQuery.ParamByName('Diff').AsFloat                          := SBKilowattHour.AsFloat;
                     MasterUpdateQuery.ParamByName('Demand').AsFloat                        := MasterDemand.AsFloat;
                     MasterUpdateQuery.ParamByName('CMMultiplier').AsFloat                  := MasterCMMultiplier.AsInteger;
                     MasterUpdateQuery.ParamByName('CMPreviousReadingKWH').AsFloat          := MasterCMPreviousReadingKWH.AsInteger;
                     MasterUpdateQuery.ParamByName('CMPresentReadingKWH').AsFloat           := MasterCMPresentReadingKWH.AsInteger;
                     MasterUpdateQuery.ParamByName('CMKilowattHour').AsFloat                := (StrToInt(SBCMLastRead.Caption) - StrToInt(SBCMPrevRead.Caption) * StrToInt(SBCMMult.Caption));
                     MasterUpdateQuery.ParamByName('CMDemand').AsFloat                      := MasterCMDemand.AsFloat;
                     MasterUpdateQuery.ParamByName('KilowattHour').AsFloat                  := SBKilowattHour.AsFloat;
                     MasterUpdateQuery.ParamByName('KilowattUsed').AsFloat                  := MasterDemand.AsFloat;
                     MasterUpdateQuery.ParamByName('GenSysCharge').AsFloat                  := BillGenSysCharge;
                     MasterUpdateQuery.ParamByName('HostCommCharge').AsFloat                := BillHostCommCharge;
                     MasterUpdateQuery.ParamByName('ForexCharge').AsFloat                   := BillForexCharge;
                     MasterUpdateQuery.ParamByName('TCDemandCharge').AsFloat                := BillTCDemandCharge;
                     MasterUpdateQuery.ParamByName('TCTransSystemCharge').AsFloat           := BillTCTransSystemCharge;
                     MasterUpdateQuery.ParamByName('SystemLossCharge').AsFloat              := BillSystemLossCharge;
                     MasterUpdateQuery.ParamByName('DCDemandCharge').AsFloat                := BillDCDemandCharge;
                     MasterUpdateQuery.ParamByName('DCDistributionCharge').AsFloat          := BillDCDistributionCharge;
                     MasterUpdateQuery.ParamByName('SCRetCustCharge').AsFloat               := BillSCRetCustCharge;
                     MasterUpdateQuery.ParamByName('SCSupplySysCharge').AsFloat             := BillSCSupplySysCharge;
                     MasterUpdateQuery.ParamByName('MCRetailCustCharge').AsFloat            := BillMCRetailCustCharge;
                     MasterUpdateQuery.ParamByName('MCSystemCharge').AsFloat                := BillMCSystemCharge;
                     MasterUpdateQuery.ParamByName('UCNPCStrandedDebts').AsFloat            := BillUCNPCStrandedDebts;
                     MasterUpdateQuery.ParamByName('UCNPCStrandedContCost').AsFloat         := BillUCNPCStrandedContCost;
                     MasterUpdateQuery.ParamByName('UCDUStrandedContCost').AsFloat          := BillUCDUStrandedContCost;
                     MasterUpdateQuery.ParamByName('UCME').AsFloat                          := BillUCME;
                     MasterUpdateQuery.ParamByName('UCEqTaxesAndRoyalties').AsFloat         := BillUCEqTaxesAndRoyalties;
                     MasterUpdateQuery.ParamByName('UCEC').AsFloat                          := BillUCEC;
                     MasterUpdateQuery.ParamByName('UCCrossSubRemoval').AsFloat             := BillUCCrossSubRemoval;
                     MasterUpdateQuery.ParamByName('ICCrossSubsidyCharge').AsFloat          := BillICCrossSubsidyCharge;
                     MasterUpdateQuery.ParamByName('PowerActRateRed').AsFloat               := BillPowerActRateRed;
                     MasterUpdateQuery.ParamByName('LifelineDiscSubs').AsFloat              := BillLifelineDiscSubs;
                     MasterUpdateQuery.ParamByName('LoanCondo').AsFloat                     := BillLoanCondo;
                     MasterUpdateQuery.ParamByName('TransformerRental').AsFloat             := MasterTransformerRental.AsFloat;
                     MasterUpdateQuery.ParamByName('OCAmount1').AsFloat                     := MasterOCAmount1.AsFloat;
                     MasterUpdateQuery.ParamByName('OCAmount2').AsFloat                     := MasterOCAmount2.AsFloat;
                     MasterUpdateQuery.ParamByName('OCAmount3').AsFloat                     := MasterOCAmount3.AsFloat;
                     MasterUpdateQuery.ParamByName('TotalBill').AsFloat                     := BillTotalBill;
                     MasterUpdateQuery.ParamByName('BillNumber').Text                       := POEBRNumber[I];
                     MasterUpdateQuery.ParamByName('OEBRNumber').Text                       := POEBRNumber[I];
                     MasterUpdateQuery.ParamByName('BillMonth').Text                        := SBBillMonth.Text;
                     MasterUpdateQuery.ParamByName('VATDiscAmt').AsFloat                    := BillVATDiscAmt;
                     MasterUpdateQuery.ParamByName('VATDistDiscAmt').AsFloat                := BillVATDistDiscAmt;
                     MasterUpdateQuery.ParamByName('VATGenCODiscAmt').AsFloat               := BillVATGenCoDiscAmt;
                     MasterUpdateQuery.ParamByName('VATTransCODiscAmt').AsFloat             := BillVATTransCoDiscAmt;
                     MasterUpdateQuery.ParamByName('VATSystemLossDiscAmt').AsFloat          := BillVATSystemLossDiscAmt;
                     MasterUpdateQuery.ParamByName('VAT').AsFloat                           := BillVAT;
                     MasterUpdateQuery.ParamByName('VATDist').AsFloat                       := BillVATDist;
                     MasterUpdateQuery.ParamByName('VATGenCO').AsFloat                      := VATGenCO;
                     MasterUpdateQuery.ParamByName('VATTransCO').AsFloat                    := VATTransCO;
                     MasterUpdateQuery.ParamByName('VATSystemLossGenCO').AsFloat            := VATSystemLoss;
                     MasterUpdateQuery.ParamByName('VATSystemLossTransCO').AsFloat          := 0.00;
                     MasterUpdateQuery.ParamByName('PrevYearAdjPowerCost').AsFloat          := BillPrevYearAdjPowerCost;
                     MasterUpdateQuery.ParamByName('SysLossUnderRecov').AsFloat             := BillSysLossUnderRecov;
                     MasterUpdateQuery.ParamByName('code').AsFloat                          := MasterCode.AsFloat;

                     MasterUpdateQuery.Execute;
